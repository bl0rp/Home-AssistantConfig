  - platform: template
    sensors:
      solar_angle:
        value_template: '{{ states.sun.sun.attributes.elevation }}'
        friendly_name: 'Sun angle'
        unit_of_measurement: 'degrees'
      sunrise:
        value_template: '{{ states.sun.sun.attributes.next_rising }}'
### home->Online fÃ¼r landev group
      technicolor:
        friendly_name: 'Unitymedia Technicolor Router'
        value_template: "{{ 'Online' if is_state('device_tracker.technicolor', 'home') else 'Offline' }}"
      ddwrt:
        friendly_name: 'DD-WRT Router 1.OG'
        value_template: "{{ 'Online' if is_state('device_tracker.ddwrt', 'home') else 'Offline' }}"
      qnap1:
        friendly_name: 'QNAP TS-563'
        value_template: "{{ 'Online' if is_state('device_tracker.qnap1', 'home') else 'Offline' }}"
      alekto:
        friendly_name: 'WKS Windows 10'
        value_template: "{{ 'Online' if is_state('device_tracker.wks_alekto', 'home') else 'Offline' }}"
      pi1wlan:
        friendly_name: 'RaspberryPi 1 via WLAN'
        value_template: "{{ 'Online' if is_state('device_tracker.pi1wlan', 'home') else 'Offline' }}"
      pi1eth:
        friendly_name: 'RaspberryPi 1 via Ethernet'
        value_template: "{{ 'Online' if is_state('device_tracker.pi1eth', 'home') else 'Offline' }}"
      pi2kodi:
        friendly_name: 'RaspberryPi 2 (Kodi)'
        value_template: "{{ 'Online' if is_state('device_tracker.pi2kodi', 'home') else 'Offline' }}"
      chmbp:
        friendly_name: 'MacBook Pro'
        value_template: "{{ 'Online' if is_state('device_tracker.chmbp', 'home') else 'Offline' }}"
      ipad:
        friendly_name: 'iPad'
        value_template: "{{ 'Online' if is_state('device_tracker.ipad', 'home') else 'Offline' }}"
      nexus7:
        friendly_name: 'Nexus Tablet'
        value_template: "{{ 'Online' if is_state('device_tracker.nexus7', 'home') else 'Offline' }}"
      wemoswitch1:
        friendly_name: 'Wemo Switch 1'
        value_template: "{{ 'Online' if is_state('device_tracker.wemoswitch1', 'home') else 'Offline' }}"
      wemoswitch2:
        friendly_name: 'Wemo Switch 2'
        value_template: "{{ 'Online' if is_state('device_tracker.wemoswitch2', 'home') else 'Offline' }}"
      esp8266_01:
        friendly_name: 'ESP8266 #1'
        value_template: "{{ 'Online' if is_state('device_tracker.esp8266_01', 'home') else 'Offline' }}"
      esp8266_02:
        friendly_name: 'ESP8266 #2'
        value_template: "{{ 'Online' if is_state('device_tracker.esp8266_02', 'home') else 'Offline' }}"
      esp8266_03:
        friendly_name: 'ESP8266 #3'
        value_template: "{{ 'Online' if is_state('device_tracker.esp8266_03', 'home') else 'Offline' }}"
      esp8266_04:
        friendly_name: 'ESP8266 #4'
        value_template: "{{ 'Online' if is_state('device_tracker.esp8266_04', 'home') else 'Offline' }}"
      esp8266_05:
        friendly_name: 'ESP8266 #5'
        value_template: "{{ 'Online' if is_state('device_tracker.esp8266_05', 'home') else 'Offline' }}"
#Status ESP* -> view esp
#in short:
#      esp8266_01_status:
#        friendly_name: 'ESP8266 #1'
#        value_template: "{{ states('sensor.esp8266_01_status_2') if is_state('device_tracker.esp8266_01_ping', 'home') else 'Offline' }}"
      esp8266_01_status_var:
        friendly_name: "ESP8266 01 Status"
        value_template: >-
           {%- if is_state('device_tracker.esp8266_01_ping', 'home') -%}
             Online! Uptime: {{ states.sensor.esp8266_01_uptime_human.state }}
           {%- else -%}
             Sensor ist offline!
           {%- endif -%}
      esp8266_02_status_var:
        friendly_name: "ESP8266 02 Status"
        value_template: >-
           {%- if is_state('device_tracker.esp8266_02_ping', 'home') -%}
             Online! Uptime: {{ states.sensor.esp8266_02_uptime_human.state }}
           {%- else -%}
             Sensor ist offline!
           {%- endif -%}
      esp8266_03_status_var:
        friendly_name: "ESP8266 03 Status"
        value_template: >-
           {%- if is_state('device_tracker.esp8266_03_ping', 'home') -%}
             Online! Uptime: {{ states.sensor.esp8266_03_uptime_human.state }}
           {%- else -%}
             Sensor ist offline!
           {%- endif -%}
      esp8266_04_status_var:
        friendly_name: "ESP8266 04 Status"
        value_template: >-
           {%- if is_state('device_tracker.esp8266_04_ping', 'home') -%}
             Online! Uptime: {{ states.sensor.esp8266_04_uptime_human.state }}
           {%- else -%}
             Sensor ist offline!
           {%- endif -%}
      esp8266_05_status_var:
        friendly_name: "ESP8266 05 Status"
        value_template: >-
           {%- if is_state('device_tracker.esp8266_05_ping', 'home') -%}
             Online! Uptime: {{ states.sensor.esp8266_05_uptime_human.state }}
           {%- else -%}
             Sensor ist offline!
           {%- endif -%}


###Uptime to human readable espXX (thanks to @dale3h and @BillyNate)
      esp8266_01_uptime_human:
        friendly_name: Uptime ESP8266_01
        value_template: >-
           {% macro human_time(seconds) -%}
             {%- set seconds = seconds|int -%}
             {%- set comma = joiner(', ') -%}
             {%- set intervals = {
               'weeks': 60 * 60 * 24 * 7,
               'days': 60 * 60 * 24,
               'hours': 60 * 60,
               'minutes': 60,
               'seconds': 1,
             } -%}
           
             {%- set weeks = seconds // intervals.weeks -%}
             {%- set seconds = seconds % intervals.weeks -%}
             {{- comma() ~ weeks ~ ' week' ~ ('s' if weeks != 1) if weeks -}}
           
             {%- set days = seconds // intervals.days -%}
             {%- set seconds = seconds % intervals.days -%}
             {{- comma() ~ days ~ ' day' ~ ('s' if days != 1) if days -}}
           
             {%- set hours = seconds // intervals.hours -%}
             {%- set seconds = seconds % intervals.hours -%}
             {{- comma() ~ hours ~ ' hour' ~ ('s' if hours != 1) if hours -}}
           
             {%- set minutes = seconds // intervals.minutes -%}
             {{- comma() ~ minutes ~ ' minute' ~ ('s' if minutes != 1) if minutes -}}
           
             {%- set seconds = seconds % intervals.minutes -%}
             {{- comma() ~ seconds ~ ' second' ~ ('s' if seconds != 1) if seconds -}}
           {%- endmacro %}
           {{ human_time(states.sensor.esp8266_01_uptime.state | int * 60) }}

      esp8266_02_uptime_human:
        friendly_name: Uptime ESP8266_02
        value_template: >-
           {% macro human_time(seconds) -%}
             {%- set seconds = seconds|int -%}
             {%- set comma = joiner(', ') -%}
             {%- set intervals = {
               'weeks': 60 * 60 * 24 * 7,
               'days': 60 * 60 * 24,
               'hours': 60 * 60,
               'minutes': 60,
               'seconds': 1,
             } -%}
           
             {%- set weeks = seconds // intervals.weeks -%}
             {%- set seconds = seconds % intervals.weeks -%}
             {{- comma() ~ weeks ~ ' week' ~ ('s' if weeks != 1) if weeks -}}
           
             {%- set days = seconds // intervals.days -%}
             {%- set seconds = seconds % intervals.days -%}
             {{- comma() ~ days ~ ' day' ~ ('s' if days != 1) if days -}}
           
             {%- set hours = seconds // intervals.hours -%}
             {%- set seconds = seconds % intervals.hours -%}
             {{- comma() ~ hours ~ ' hour' ~ ('s' if hours != 1) if hours -}}
           
             {%- set minutes = seconds // intervals.minutes -%}
             {{- comma() ~ minutes ~ ' minute' ~ ('s' if minutes != 1) if minutes -}}
           
             {%- set seconds = seconds % intervals.minutes -%}
             {{- comma() ~ seconds ~ ' second' ~ ('s' if seconds != 1) if seconds -}}
           {%- endmacro %}
           {{ human_time(states.sensor.esp8266_02_uptime.state | int * 60) }}

      esp8266_03_uptime_human:
        friendly_name: Uptime ESP8266_03
        value_template: >-
           {% macro human_time(seconds) -%}
             {%- set seconds = seconds|int -%}
             {%- set comma = joiner(', ') -%}
             {%- set intervals = {
               'weeks': 60 * 60 * 24 * 7,
               'days': 60 * 60 * 24,
               'hours': 60 * 60,
               'minutes': 60,
               'seconds': 1,
             } -%}
           
             {%- set weeks = seconds // intervals.weeks -%}
             {%- set seconds = seconds % intervals.weeks -%}
             {{- comma() ~ weeks ~ ' week' ~ ('s' if weeks != 1) if weeks -}}
           
             {%- set days = seconds // intervals.days -%}
             {%- set seconds = seconds % intervals.days -%}
             {{- comma() ~ days ~ ' day' ~ ('s' if days != 1) if days -}}
           
             {%- set hours = seconds // intervals.hours -%}
             {%- set seconds = seconds % intervals.hours -%}
             {{- comma() ~ hours ~ ' hour' ~ ('s' if hours != 1) if hours -}}
           
             {%- set minutes = seconds // intervals.minutes -%}
             {{- comma() ~ minutes ~ ' minute' ~ ('s' if minutes != 1) if minutes -}}
           
             {%- set seconds = seconds % intervals.minutes -%}
             {{- comma() ~ seconds ~ ' second' ~ ('s' if seconds != 1) if seconds -}}
           {%- endmacro %}
           {{ human_time(states.sensor.esp8266_03_uptime.state | int * 60) }}

      esp8266_04_uptime_human:
        friendly_name: Uptime ESP8266_04
        value_template: >-
           {% macro human_time(seconds) -%}
             {%- set seconds = seconds|int -%}
             {%- set comma = joiner(', ') -%}
             {%- set intervals = {
               'weeks': 60 * 60 * 24 * 7,
               'days': 60 * 60 * 24,
               'hours': 60 * 60,
               'minutes': 60,
               'seconds': 1,
             } -%}
           
             {%- set weeks = seconds // intervals.weeks -%}
             {%- set seconds = seconds % intervals.weeks -%}
             {{- comma() ~ weeks ~ ' week' ~ ('s' if weeks != 1) if weeks -}}
           
             {%- set days = seconds // intervals.days -%}
             {%- set seconds = seconds % intervals.days -%}
             {{- comma() ~ days ~ ' day' ~ ('s' if days != 1) if days -}}
           
             {%- set hours = seconds // intervals.hours -%}
             {%- set seconds = seconds % intervals.hours -%}
             {{- comma() ~ hours ~ ' hour' ~ ('s' if hours != 1) if hours -}}
           
             {%- set minutes = seconds // intervals.minutes -%}
             {{- comma() ~ minutes ~ ' minute' ~ ('s' if minutes != 1) if minutes -}}
           
             {%- set seconds = seconds % intervals.minutes -%}
             {{- comma() ~ seconds ~ ' second' ~ ('s' if seconds != 1) if seconds -}}
           {%- endmacro %}
           {{ human_time(states.sensor.esp8266_04_uptime.state | int * 60) }}

      esp8266_05_uptime_human:
        friendly_name: Uptime ESP8266_05
        value_template: >-
           {% macro human_time(seconds) -%}
             {%- set seconds = seconds|int -%}
             {%- set comma = joiner(', ') -%}
             {%- set intervals = {
               'weeks': 60 * 60 * 24 * 7,
               'days': 60 * 60 * 24,
               'hours': 60 * 60,
               'minutes': 60,
               'seconds': 1,
             } -%}
           
             {%- set weeks = seconds // intervals.weeks -%}
             {%- set seconds = seconds % intervals.weeks -%}
             {{- comma() ~ weeks ~ ' week' ~ ('s' if weeks != 1) if weeks -}}
           
             {%- set days = seconds // intervals.days -%}
             {%- set seconds = seconds % intervals.days -%}
             {{- comma() ~ days ~ ' day' ~ ('s' if days != 1) if days -}}
           
             {%- set hours = seconds // intervals.hours -%}
             {%- set seconds = seconds % intervals.hours -%}
             {{- comma() ~ hours ~ ' hour' ~ ('s' if hours != 1) if hours -}}
           
             {%- set minutes = seconds // intervals.minutes -%}
             {{- comma() ~ minutes ~ ' minute' ~ ('s' if minutes != 1) if minutes -}}
           
             {%- set seconds = seconds % intervals.minutes -%}
             {{- comma() ~ seconds ~ ' second' ~ ('s' if seconds != 1) if seconds -}}
           {%- endmacro %}
           {{ human_time(states.sensor.esp8266_05_uptime.state | int * 60) }}

### ESP8266_XX Bewegungsmelder
      esp8266_01_motion:
        friendly_name: Wohnzimmer
        value_template: '{% if is_state("sensor.esp8266_01_pir", "1") %}Bewegung erkannt!{% else %}Keine Bewegung.{% endif %}'
        icon_template: '{% if is_state("sensor.esp8266_01_pir", "1") %}mdi:alert{% else %}mdi:eye-off{% endif %}'

      esp8266_02_motion:
        friendly_name: ELW
        value_template: '{% if is_state("sensor.esp8266_02_pir", "1") %}Bewegung erkannt!{% else %}Keine Bewegung.{% endif %}'
        icon_template: '{% if is_state("sensor.esp8266_02_pir", "1") %}mdi:alert{% else %}mdi:eye-off{% endif %}'

      esp8266_03_motion:
        friendly_name: Wintergarten
        value_template: '{% if is_state("sensor.esp8266_03_pir", "1") %}Bewegung erkannt!{% else %}Keine Bewegung.{% endif %}'
        icon_template: '{% if is_state("sensor.esp8266_03_pir", "1") %}mdi:alert{% else %}mdi:eye-off{% endif %}'

      esp8266_04_motion:
        friendly_name: esp8266 04
        value_template: '{% if is_state("sensor.esp8266_04_pir", "1") %}Bewegung erkannt!{% else %}Keine Bewegung.{% endif %}'
        icon_template: '{% if is_state("sensor.esp8266_04_pir", "1") %}mdi:alert{% else %}mdi:eye-off{% endif %}'

      esp8266_05_motion:
        friendly_name: esp8266 05
        value_template: '{% if is_state("sensor.esp8266_05_pir", "1") %}Bewegung erkannt!{% else %}Keine Bewegung.{% endif %}'
        icon_template: '{% if is_state("sensor.esp8266_05_pir", "1") %}mdi:alert{% else %}mdi:eye-off{% endif %}'

### systemmonitor
      process_sshd_format:
        friendly_name: 'SSH Daemon'
        value_template: "{{ 'running' if is_state('sensor.process_sshd', 'on') else 'stopped' }}"
        icon_template: '{% if is_state("sensor.process_sshd", "on") %}mdi:checkbox-marked-circle-outline{% else %}mdi:alert{% endif %}'
      process_autossh_format:
        friendly_name: 'autossh tunnel script'
        icon_template: '{% if is_state("sensor.process_autossh", "on") %}mdi:checkbox-marked-circle-outline{% else %}mdi:alert{% endif %}'
        value_template: "{{ 'running' if is_state('sensor.process_autossh', 'on') else 'stopped' }}"
      process_dhcpd_format:
        friendly_name: 'DHCPD Daemon'
        icon_template: '{% if is_state("sensor.process_dhcpd", "on") %}mdi:checkbox-marked-circle-outline{% else %}mdi:alert{% endif %}'
        value_template: "{{ 'running' if is_state('sensor.process_dhcpd', 'on') else 'stopped' }}"
      process_mosquitto_format:
        friendly_name: 'MQTT Daemon'
        icon_template: '{% if is_state("sensor.process_mosquitto", "on") %}mdi:checkbox-marked-circle-outline{% else %}mdi:alert{% endif %}'
        value_template: "{{ 'running' if is_state('sensor.process_mosquitto', 'on') else 'stopped' }}"

### MPD Dose
      mpd_use:
        friendly_name: Steckdose in Benutzung?
        value_template: "{{ states('sensor.fibaro_system_fgwpef_wall_plug_gen5_power_3_4') | int > 0.2 }}"

### Multisensor1 Battery
      multisensor1_battery:
        value_template: >-
           {%- if states.binary_sensor.aeotec_zw100_multisensor_6_sensor_2_0 != None -%}
             {{ states.zwave.aeotec_zw100_multisensor_6_2.attributes.battery_level }}
           {%- else -%}
             unknown
           {%- endif -%}
        unit_of_measurement: '%'
        friendly_name: "Multisensor 01 Batterie"

### Multisensor1 Bewegungsmelder
      multisensor1_motion:
        friendly_name: Multisensor 01
        value_template: '{% if is_state("sensor.aeotec_zw100_multisensor_6_burglar_2_10", "8") %}Bewegung erkannt!{% else %}Keine Bewegung.{% endif %}'
        icon_template: '{% if is_state("sensor.aeotec_zw100_multisensor_6_burglar_2_10", "8") %}mdi:alert{% else %}mdi:eye-off{% endif %}'

### Last Motion

      template_pir_motion:
        friendly_name: 'Motion Location'
        value_template: >
                    {%- set pirs = [states.sensor.multisensor1_motion,states.sensor.esp8266_01_motion, states.sensor.esp8266_02_motion, states.sensor.esp8266_03_motion] %}
                    {% for pir in pirs %}
                      {% if as_timestamp(pir.last_changed) == as_timestamp(pirs | map(attribute='last_changed') | max) %}
                        {{ pir.name }}
                      {% endif %}
                    {% endfor %}
### last_motion_timestamp
      elw_motion_last_triggered:
        friendly_name: "ELW Motion Last Triggered"
        value_template: >-
          {{ as_timestamp(states.sensor.esp8266_02_motion.last_changed)|timestamp_custom('%H:%M:%S %d.%m.%Y') }}

      elw_2_motion_last_triggered:
        friendly_name: "ELW Flur Motion Last Triggered"
        value_template: >-
          {{ as_timestamp(states.sensor.multisensor1_motion.last_changed)|timestamp_custom('%H:%M:%S %d.%m.%Y') }}

      wintergarten_motion_last_triggered:
        friendly_name: "Wintergarten Motion Last Triggered"
        value_template: >-
          {{ as_timestamp(states.sensor.esp8266_03_motion.last_changed)|timestamp_custom('%H:%M:%S %d.%m.%Y') }}

      wohnzimmer_motion_last_triggered:
        friendly_name: "Wohnzimmer Motion Last Triggered"
        value_template: >-
          {{ as_timestamp(states.sensor.esp8266_01_motion.last_changed)|timestamp_custom('%H:%M:%S %d.%m.%Y') }}

      esp8266_05_motion_last_triggered:
        friendly_name: "esp8266 #5  Motion Last Triggered"
        value_template: >-
          {{ as_timestamp(states.sensor.esp8266_05_motion.last_changed)|timestamp_custom('%H:%M:%S %d.%m.%Y') }}