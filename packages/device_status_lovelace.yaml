##############################################################
### Packages / Device Status  & customize Lovelace         ###
### @cvoid - https://github.com/bl0rp/Home-AssistantConfig ###
### Thanks 2 Norien                                        ###
### https://github.com/Norien/Home-Assistant-Config/       ###
# find all device_tracker entities:                        ###
#                                                          ###
# {%- set domains = [states.device_tracker,  ] %}          ###
#                                                          ###
# {{ "Entity ID".ljust(50) }}  {{ "Entity Name" }}         ###
#                                                          ###
# {%- for domain in domains %}                             ###
# {% for item in domain %}                                 ###
# {{ item.entity_id.ljust(50) }} {{ item.name }}           ###
#                                                          ###
# {%- endfor %}                                            ###
# {%- endfor %}                                            ###
# or for the customize layout:                             ###
# {%- set domains = [states.device_tracker,  ] %}          ###
#                                                          ###
# {{ "Entity ID".ljust(50) }}  {{ "Entity Name" }}         ###
#                                                          ###
# {%- for domain in domains %}                             ###
# {% for item in domain %}                                 ###
# {{ item.entity_id }}:                                    ###
#   icon: mdi:                                             ###
# {%- endfor %}                                            ###
# {%- endfor %}                                            ###
##############################################################

homeassistant:

  customize:
#GPSLogger
    device_tracker.897y04duz:
      friendly_name: GPSLogger Pixel3 XL
      icon: mdi:radar
#network
    device_tracker.network_ap_ddwrt:
      friendly_name: "WiFi AP DD-WRT"
      icon: mdi:router-wireless
    device_tracker.network_ap_gateway:
      friendly_name: "Router ISP"
      icon: mdi:router-wireless
    device_tracker.network_ap_unifi_elw:
      friendly_name: "WiFi AP Unifi ELW"
      icon: mdi:router-wireless
#network hub
    device_tracker.network_hub_echo_dot:
      friendly_name: "Echo Dot"
      icon: mdi:amazon-alexa
    device_tracker.network_hub_tradfri:
      friendly_name: "Tradfri Hub"
      icon: mdi:zigbee
#media player
    device_tracker.network_media_player_pi2kodi:
      friendly_name: "Kodi"
      icon: mdi:kodi
    device_tracker.network_media_player_volumio:
      friendly_name: "Volumio"
      icon: mdi:library-music
    device_tracker.network_media_player_yamaha_rxv473:
      friendly_name: "Verstärker"
      icon: mdi:speaker
#printer
    device_tracker.network_printer_hp_1og:
      friendly_name: "HP Deskjet Büro"
      icon: mdi:printer
#storage
    device_tracker.network_storage_qnap1:
      friendly_name: "Qnap 1"
      icon: mdi:nas
#espxx, RaspberryPi
    device_tracker.soc_esp32_01:
      friendly_name: "ESP32 #1"
      icon: mdi:chip
    device_tracker.soc_esp32_02:
      friendly_name: "ESP32 #2"
      icon: mdi:chip
    device_tracker.soc_esp32_03:
      friendly_name: "ESP32 #3"
      icon: mdi:chip
    device_tracker.soc_esp8266_01:
      friendly_name: "ESP8266 #1"
      icon: mdi:chip
    device_tracker.soc_esp8266_02:
      friendly_name: "ESP8266 #2"
      icon: mdi:chip
    device_tracker.soc_esp8266_03:
      friendly_name: "ESP8266 #3"
      icon: mdi:chip
    device_tracker.soc_esp8266_04:
      friendly_name: "ESP8266 #4"
      icon: mdi:chip
    device_tracker.soc_esp8266_05:
      friendly_name: "ESP8266 #5"
      icon: mdi:chip
    device_tracker.soc_esp8266_07:
      friendly_name: "ESP8266 #7"
      icon: mdi:chip
    device_tracker.soc_pi1_wifi:
      friendly_name: "RaspberryPi WiFi (Camera)"
      icon: mdi:chip
    device_tracker.soc_pizero_wifi:
      friendly_name: "RaspberryPi Zero (BT)"
      icon: mdi:chip
#sonoff wemo
    device_tracker.switch_sonoff_sonoff1:
      friendly_name: "Sonoff #1"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff2:
      friendly_name: "Sonoff #2"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff3:
      friendly_name: "Sonoff #3"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff4:
      friendly_name: "Sonoff #4"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff5:
      friendly_name: "Sonoff #5"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff6:
      friendly_name: "Sonoff #6"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff7:
      friendly_name: "Sonoff #7"
      icon: mdi:power-socket-eu
    device_tracker.switch_sonoff_sonoff8:
      friendly_name: "Sonoff #8"
      icon: mdi:power-socket-eu
    device_tracker.switch_wemo_wemoswitch1:
      friendly_name: "WeMo Switch #1"
      icon: mdi:power-socket-eu
    device_tracker.switch_wemo_wemoswitch2:
      friendly_name: "WeMo Switch #2"
      icon: mdi:power-socket-eu
#computers, tablets
    device_tracker.user_devices_computer_chris_macbook:
      friendly_name: "Macbook Christoph"
      icon: mdi:laptop-mac
    device_tracker.user_devices_computer_chris_workstation:
      friendly_name: "Workstation Christoph"
      icon: mdi:desktop-tower-monitor
    device_tracker.user_devices_computer_ipad:
      friendly_name: "iPad"
      icon: mdi:tablet-ipad
    device_tracker.user_devices_computer_nexus7:
      friendly_name: "Tablet Android"
      icon: mdi:tablet-android
#mobile phones
    device_tracker.user_devices_phone_christoph:
      friendly_name: "Christoph (Wifi)"
      icon: mdi:wifi
    device_tracker.user_devices_phone_ewald:
      friendly_name: "Ewald (WiFi)"
      icon: mdi:wifi
    device_tracker.user_devices_phone_jan:
      friendly_name: "Jan (WiFi)"
      icon: mdi:wifi
    device_tracker.user_devices_phone_johanna:
      friendly_name: "Johanna (WiFi)"
      icon: mdi:wifi
    device_tracker.user_devices_phone_petros:
      friendly_name: "Petros (WiFi)"
      icon: mdi:wifi
    device_tracker.user_devices_phone_steffi:
      friendly_name: "Steffio (WiFi)"
      icon: mdi:wifi
    device_tracker.user_devices_phone_traude:
      friendly_name: "Traude (Wifi)"
      icon: mdi:wifi

############## Customize for sensor Online/Offline
    sensor.clients_online:
      friendly_name: "Geräte im Netzwerk"
      icon: mdi:binoculars
      unit_of_measurement: '#'
#GPSLogger
    sensor.897y04duz:
      friendly_name: GPSLogger Pixel3 XL
      icon: mdi:radar
#network
    sensor.network_ap_ddwrt:
      friendly_name: "WiFi AP DD-WRT"
      icon: mdi:router-wireless
    sensor.network_ap_gateway:
      friendly_name: "Router ISP"
      icon: mdi:router-wireless
    sensor.network_ap_unifi_elw:
      friendly_name: "WiFi AP Unifi ELW"
      icon: mdi:router-wireless
#network hub
    sensor.network_hub_echo_dot:
      friendly_name: "Echo Dot"
      icon: mdi:amazon-alexa
    sensor.network_hub_tradfri:
      friendly_name: "Tradfri Hub"
      icon: mdi:zigbee
#media player
    sensor.network_media_player_pi2kodi:
      friendly_name: "Kodi"
      icon: mdi:kodi
    sensor.network_media_player_volumio:
      friendly_name: "Volumio"
      icon: mdi:library-music
    sensor.network_media_player_yamaha_rxv473:
      friendly_name: "Verstärker"
      icon: mdi:speaker
#printer
    sensor.network_printer_hp_1og:
      friendly_name: "HP Deskjet Büro"
      icon: mdi:printer
#storage
    sensor.network_storage_qnap1:
      friendly_name: "Qnap 1"
      icon: mdi:nas
#espxx, RaspberryPi
    sensor.soc_esp32_01:
      friendly_name: "ESP32 #1"
      icon: mdi:chip
    sensor.soc_esp32_02:
      friendly_name: "ESP32 #2"
      icon: mdi:chip
    sensor.soc_esp32_03:
      friendly_name: "ESP32 #3"
      icon: mdi:chip
    sensor.soc_esp8266_01:
      friendly_name: "ESP8266 #1"
      icon: mdi:chip
    sensor.soc_esp8266_02:
      friendly_name: "ESP8266 #2"
      icon: mdi:chip
    sensor.soc_esp8266_03:
      friendly_name: "ESP8266 #3"
      icon: mdi:chip
    sensor.soc_esp8266_04:
      friendly_name: "ESP8266 #4"
      icon: mdi:chip
    sensor.soc_esp8266_05:
      friendly_name: "ESP8266 #5"
      icon: mdi:chip
    sensor.soc_esp8266_07:
      friendly_name: "ESP8266 #7 (OpenMQTT RF)"
      icon: mdi:chip
    sensor.soc_pi1_wifi:
      friendly_name: "RaspberryPi WiFi (Camera)"
      icon: mdi:chip
    sensor.soc_pizero_wifi:
      friendly_name: "RaspberryPi Zero (BT)"
      icon: mdi:chip
#sonoff wemo
    sensor.switch_sonoff_sonoff1:
      friendly_name: "Sonoff #1"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff2:
      friendly_name: "Sonoff #2"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff3:
      friendly_name: "Sonoff #3"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff4:
      friendly_name: "Sonoff #4"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff5:
      friendly_name: "Sonoff #5"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff6:
      friendly_name: "Sonoff #6"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff7:
      friendly_name: "Sonoff #7"
      icon: mdi:power-socket-eu
    sensor.switch_sonoff_sonoff8:
      friendly_name: "Sonoff #8"
      icon: mdi:power-socket-eu
    sensor.switch_wemo_wemoswitch1:
      friendly_name: "WeMo Switch #1"
      icon: mdi:power-socket-eu
    sensor.switch_wemo_wemoswitch2:
      friendly_name: "WeMo Switch #2"
      icon: mdi:power-socket-eu
#computers, tablets
    sensor.user_devices_computer_chris_macbook:
      friendly_name: "Macbook Christoph"
      icon: mdi:laptop-mac
    sensor.user_devices_computer_chris_workstation:
      friendly_name: "Workstation Christoph"
      icon: mdi:desktop-tower-monitor
    sensor.user_devices_computer_ipad:
      friendly_name: "iPad"
      icon: mdi:tablet-ipad
    sensor.user_devices_computer_nexus7:
      friendly_name: "Tablet Android"
      icon: mdi:tablet-android
#mobile phones
    sensor.user_devices_phone_christoph:
      friendly_name: "Christoph (Wifi)"
      icon: mdi:wifi
    sensor.user_devices_phone_ewald:
      friendly_name: "Ewald (WiFi)"
      icon: mdi:wifi
    sensor.user_devices_phone_jan:
      friendly_name: "Jan (WiFi)"
      icon: mdi:wifi
    sensor.user_devices_phone_johanna:
      friendly_name: "Johanna (WiFi)"
      icon: mdi:wifi
    sensor.user_devices_phone_petros:
      friendly_name: "Petros (WiFi)"
      icon: mdi:wifi
    sensor.user_devices_phone_steffi:
      friendly_name: "Steffio (WiFi)"
      icon: mdi:wifi
    sensor.user_devices_phone_traude:
      friendly_name: "Traude (Wifi)"
      icon: mdi:wifi



#group files for Lovelace auto-entity sorting

group:
  device_tracker_complete:
    entities:
      - device_tracker.897y04duz
      - device_tracker.network_ap_ddwrt
      - device_tracker.network_ap_gateway
      - device_tracker.network_ap_unifi_elw
      - device_tracker.network_hub_echo_dot
      - device_tracker.network_hub_tradfri
      - device_tracker.network_media_player_pi2kodi
      - device_tracker.network_media_player_volumio
      - device_tracker.network_media_player_yamaha_rxv473
      - device_tracker.network_printer_hp_1og
      - device_tracker.network_storage_qnap1
      - device_tracker.soc_esp32_01
      - device_tracker.soc_esp32_02
      - device_tracker.soc_esp32_03
      - device_tracker.soc_esp8266_01
      - device_tracker.soc_esp8266_02
      - device_tracker.soc_esp8266_03
      - device_tracker.soc_esp8266_04
      - device_tracker.soc_esp8266_05
      - device_tracker.soc_esp8266_07
      - device_tracker.soc_pi1_wifi
      - device_tracker.soc_pizero_wifi
      - device_tracker.switch_sonoff_sonoff1
      - device_tracker.switch_sonoff_sonoff2
      - device_tracker.switch_sonoff_sonoff3
      - device_tracker.switch_sonoff_sonoff4
      - device_tracker.switch_sonoff_sonoff5
      - device_tracker.switch_sonoff_sonoff6
      - device_tracker.switch_sonoff_sonoff7
      - device_tracker.switch_sonoff_sonoff8
      - device_tracker.switch_wemo_wemoswitch1
      - device_tracker.switch_wemo_wemoswitch2
      - device_tracker.user_devices_computer_chris_macbook
      - device_tracker.user_devices_computer_chris_workstation
      - device_tracker.user_devices_computer_ipad
      - device_tracker.user_devices_computer_nexus7
      - device_tracker.user_devices_phone_christoph
      - device_tracker.user_devices_phone_ewald
      - device_tracker.user_devices_phone_jan
      - device_tracker.user_devices_phone_johanna
      - device_tracker.user_devices_phone_petros
      - device_tracker.user_devices_phone_steffi
      - device_tracker.user_devices_phone_traude
#use sensors for devices and device_tracker for people (home vs online)
  device_tracker_christoph:
    entities:
      - device_tracker.897y04duz
      - device_tracker.user_devices_phone_christoph
      - sensor.user_devices_computer_chris_macbook
      - sensor.user_devices_computer_chris_workstation


  device_tracker_network:
    entities:
      - sensor.network_ap_ddwrt
      - sensor.network_ap_gateway
      - sensor.network_ap_unifi_elw
      - sensor.network_hub_echo_dot
      - sensor.network_hub_tradfri
      - sensor.network_media_player_pi2kodi
      - sensor.network_media_player_volumio
      - sensor.network_media_player_yamaha_rxv473
      - sensor.network_printer_hp_1og
      - sensor.network_storage_qnap1
      - sensor.soc_pi1_wifi
      - sensor.soc_pizero_wifi
  device_tracker_network_gateway:
    entities:
      - sensor.network_ap_ddwrt
      - sensor.network_ap_gateway
      - sensor.network_ap_unifi_elw

  device_tracker_hub:
    entities:
      - sensor.network_hub_echo_dot
      - sensor.network_hub_tradfri

  device_tracker_media_player:
    entities:
      - sensor.network_media_player_pi2kodi
      - sensor.network_media_player_volumio
      - sensor.network_media_player_yamaha_rxv473


  device_tracker_soc:
    entities:
      - sensor.soc_esp32_01
      - sensor.soc_esp32_02
      - sensor.soc_esp32_03
      - sensor.soc_esp8266_01
      - sensor.soc_esp8266_02
      - sensor.soc_esp8266_03
      - sensor.soc_esp8266_04
      - sensor.soc_esp8266_05
      - sensor.soc_esp8266_07
      - sensor.soc_pi1_wifi
      - sensor.soc_pizero_wifi


  device_tracker_switch:
    entities:
      - sensor.switch_sonoff_sonoff1
      - sensor.switch_sonoff_sonoff2
      - sensor.switch_sonoff_sonoff3
      - sensor.switch_sonoff_sonoff4
      - sensor.switch_sonoff_sonoff5
      - sensor.switch_sonoff_sonoff6
      - sensor.switch_sonoff_sonoff7
      - sensor.switch_sonoff_sonoff8
      - sensor.switch_wemo_wemoswitch1
      - sensor.switch_wemo_wemoswitch2

  device_tracker_user_devices:
    entities:
      - sensor.user_devices_computer_chris_macbook
      - sensor.user_devices_computer_chris_workstation
      - sensor.user_devices_computer_ipad
      - sensor.user_devices_computer_nexus7
  device_tracker_user_phone:
    entities:
      - device_tracker.user_devices_phone_christoph
      - device_tracker.user_devices_phone_ewald
      - device_tracker.user_devices_phone_jan
      - device_tracker.user_devices_phone_johanna
      - device_tracker.user_devices_phone_petros
      - device_tracker.user_devices_phone_steffi
      - device_tracker.user_devices_phone_traude

  device_tracker_user_phone_family:
    entities:
      - device_tracker.user_devices_phone_christoph
      - device_tracker.user_devices_phone_ewald
      - device_tracker.user_devices_phone_johanna
      - device_tracker.user_devices_phone_traude

  device_tracker_user_phone_guest:
    entities:
      - device_tracker.user_devices_phone_jan
      - device_tracker.user_devices_phone_petros
      - device_tracker.user_devices_phone_steffi

# Sensors
sensor:
#All Devices network
  - platform: template
    sensors:
      clients_online:
        entity_id: sun.sun
        unit_of_measurement: '#'
        value_template: >-
            {%- for d in states.device_tracker if d.state == 'home' -%}
            {{- loop.length if loop.first -}}
            {%- endfor -%}



###### CUSTOM ONLINE // OFFLINE TEXT FOR device_tracker

## Jinja Script for dev-template:

# {%- set domains = [ states.device_tracker ] %}
# {%- for domain in domains %}
# {% for item in domain %}
# {{ item.entity_id.ljust(0)|replace("device_tracker.","") }}:{% raw %}
#   value_template: "{{'Online' if is_state('{% endraw %}{{
#  item.entity_id.ljust(0)}}{% raw %}', 'home') else 'Offline'}}"
#   {% endraw %}
# {%- endfor %}
# {%- endfor %}

      network_ap_ddwrt:
        value_template: "{{'Online' if is_state('device_tracker.network_ap_ddwrt', 'home') else 'Offline'}}"

      network_ap_gateway:
        value_template: "{{'Online' if is_state('device_tracker.network_ap_gateway', 'home') else 'Offline'}}"

      network_ap_unifi_elw:
        value_template: "{{'Online' if is_state('device_tracker.network_ap_unifi_elw', 'home') else 'Offline'}}"

      network_hub_echo_dot:
        value_template: "{{'Online' if is_state('device_tracker.network_hub_echo_dot', 'home') else 'Offline'}}"

      network_hub_tradfri:
        value_template: "{{'Online' if is_state('device_tracker.network_hub_tradfri', 'home') else 'Offline'}}"

      network_media_player_pi2kodi:
        value_template: "{{'Online' if is_state('device_tracker.network_media_player_pi2kodi', 'home') else 'Offline'}}"

      network_media_player_volumio:
        value_template: "{{'Online' if is_state('device_tracker.network_media_player_volumio', 'home') else 'Offline'}}"

      network_media_player_yamaha_rxv473:
        value_template: "{{'Online' if is_state('device_tracker.network_media_player_yamaha_rxv473', 'home') else 'Offline'}}"

      network_printer_hp_1og:
        value_template: "{{'Online' if is_state('device_tracker.network_printer_hp_1og', 'home') else 'Offline'}}"

      network_storage_qnap1:
        value_template: "{{'Online' if is_state('device_tracker.network_storage_qnap1', 'home') else 'Offline'}}"

      soc_esp32_01:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp32_01', 'home') else 'Offline'}}"

      soc_esp32_02:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp32_02', 'home') else 'Offline'}}"

      soc_esp32_03:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp32_03', 'home') else 'Offline'}}"

      soc_esp8266_01:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp8266_01', 'home') else 'Offline'}}"

      soc_esp8266_02:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp8266_02', 'home') else 'Offline'}}"

      soc_esp8266_03:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp8266_03', 'home') else 'Offline'}}"

      soc_esp8266_04:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp8266_04', 'home') else 'Offline'}}"

      soc_esp8266_05:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp8266_05', 'home') else 'Offline'}}"

      soc_esp8266_07:
        value_template: "{{'Online' if is_state('device_tracker.soc_esp8266_07', 'home') else 'Offline'}}"

      soc_pi1_wifi:
        value_template: "{{'Online' if is_state('device_tracker.soc_pi1_wifi', 'home') else 'Offline'}}"

      soc_pizero_wifi:
        value_template: "{{'Online' if is_state('device_tracker.soc_pizero_wifi', 'home') else 'Offline'}}"

      switch_sonoff_sonoff1:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff1', 'home') else 'Offline'}}"

      switch_sonoff_sonoff2:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff2', 'home') else 'Offline'}}"

      switch_sonoff_sonoff3:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff3', 'home') else 'Offline'}}"

      switch_sonoff_sonoff4:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff4', 'home') else 'Offline'}}"

      switch_sonoff_sonoff5:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff5', 'home') else 'Offline'}}"

      switch_sonoff_sonoff6:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff6', 'home') else 'Offline'}}"

      switch_sonoff_sonoff7:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff7', 'home') else 'Offline'}}"

      switch_sonoff_sonoff8:
        value_template: "{{'Online' if is_state('device_tracker.switch_sonoff_sonoff8', 'home') else 'Offline'}}"

      switch_wemo_wemoswitch1:
        value_template: "{{'Online' if is_state('device_tracker.switch_wemo_wemoswitch1', 'home') else 'Offline'}}"

      switch_wemo_wemoswitch2:
        value_template: "{{'Online' if is_state('device_tracker.switch_wemo_wemoswitch2', 'home') else 'Offline'}}"

      user_devices_computer_chris_macbook:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_computer_chris_macbook', 'home') else 'Offline'}}"

      user_devices_computer_chris_workstation:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_computer_chris_workstation', 'home') else 'Offline'}}"

      user_devices_computer_ipad:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_computer_ipad', 'home') else 'Offline'}}"

      user_devices_computer_nexus7:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_computer_nexus7', 'home') else 'Offline'}}"

      user_devices_phone_christoph:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_christoph', 'home') else 'Offline'}}"

      user_devices_phone_ewald:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_ewald', 'home') else 'Offline'}}"

      user_devices_phone_jan:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_jan', 'home') else 'Offline'}}"

      user_devices_phone_johanna:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_johanna', 'home') else 'Offline'}}"

      user_devices_phone_petros:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_petros', 'home') else 'Offline'}}"

      user_devices_phone_steffi:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_steffi', 'home') else 'Offline'}}"

      user_devices_phone_traude:
        value_template: "{{'Online' if is_state('device_tracker.user_devices_phone_traude', 'home') else 'Offline'}}"



#automation

automation:
#################################################################
### Notify when a device goes Offline or Online to the Logfile ##
#################################################################
  - alias: Notify to Logfile if Device Goes Offline
    initial_state: True
    trigger:
      platform: state
      entity_id:

        - sensor.network_ap_ddwrt
        - sensor.network_ap_gateway
        - sensor.network_ap_unifi_elw
        - sensor.network_hub_echo_dot
        - sensor.network_hub_tradfri
        - sensor.network_media_player_pi2kodi
        - sensor.network_media_player_volumio
        - sensor.network_media_player_yamaha_rxv473
        - sensor.network_printer_hp_1og
        - sensor.network_storage_qnap1
        - sensor.soc_esp32_01
        - sensor.soc_esp32_02
        - sensor.soc_esp32_03
        - sensor.soc_esp8266_01
        - sensor.soc_esp8266_02
        - sensor.soc_esp8266_03
        - sensor.soc_esp8266_04
        - sensor.soc_esp8266_05
        - sensor.soc_esp8266_07
        - sensor.soc_pi1_wifi
        - sensor.soc_pizero_wifi
        - sensor.switch_sonoff_sonoff1
        - sensor.switch_sonoff_sonoff2
        - sensor.switch_sonoff_sonoff3
        - sensor.switch_sonoff_sonoff4
        - sensor.switch_sonoff_sonoff5
        - sensor.switch_sonoff_sonoff6
        - sensor.switch_sonoff_sonoff7
        - sensor.switch_sonoff_sonoff8
        - sensor.switch_wemo_wemoswitch1
        - sensor.switch_wemo_wemoswitch2
        - sensor.user_devices_computer_chris_macbook
        - sensor.user_devices_computer_chris_workstation
        - sensor.user_devices_computer_ipad
        - sensor.user_devices_computer_nexus7
        - sensor.user_devices_phone_christoph
        - sensor.user_devices_phone_ewald
        - sensor.user_devices_phone_jan
        - sensor.user_devices_phone_johanna
        - sensor.user_devices_phone_petros
        - sensor.user_devices_phone_steffi
        - sensor.user_devices_phone_traude

    condition:
      - condition: template
        value_template: "{% if trigger.from_state and trigger.to_state %} True {% else %} False {% endif %}"
    action:
      - service: notify.device_tracker
        data_template:
          message: >
            {% if trigger.to_state.state | lower == "offline" %}
              {{ trigger.to_state.attributes.friendly_name }} ist offline ({{ now().strftime('%d.%m.%Y %H:%M:%S') }})!
            {% else %}
              {{ trigger.to_state.attributes.friendly_name }} ist online({{ now().strftime('%d.%m.%Y %H:%M:%S') }})!
            {% endif %}
#################################################
### Notify when a NodeMCU device goes Offline ###
#################################################
  - alias: ESP8266 Sensor State
    initial_state: True
    trigger:
      platform: state
      entity_id:
        - sensor.soc_esp8266_01
        - sensor.soc_esp8266_02
        - sensor.soc_esp8266_03
        - sensor.soc_esp8266_07
      from: 'Online'
      to: 'Offline'
      for:
        minutes: 2
    action:
      - service: notify.pushbullet
        data_template:
          message: >
             Achtung! {{ now().strftime('%d.%m.%Y %H:%M:%S') }} {{ trigger.to_state.attributes.friendly_name }} ist offline!
#################################################
### Notify when a critical device goes Offline ###
#################################################
  - alias: critical device Sensor State
    initial_state: True
    trigger:
      platform: state
      entity_id:
        - sensor.network_ap_ddwrt
        - sensor.network_ap_unifi_elw
        - sensor.network_hub_echo_dot
        - sensor.network_hub_tradfri
        - sensor.network_storage_qnap1
        - sensor.switch_sonoff_sonoff1
        - sensor.switch_sonoff_sonoff2
        - sensor.switch_sonoff_sonoff3
        - sensor.switch_sonoff_sonoff4
        - sensor.switch_sonoff_sonoff5
        - sensor.switch_sonoff_sonoff6
        - sensor.switch_sonoff_sonoff7
        - sensor.switch_sonoff_sonoff8
        - sensor.switch_wemo_wemoswitch1
        - sensor.switch_wemo_wemoswitch2

      from: 'Online'
      to: 'Offline'
      for:
        minutes: 2
    action:
      - service: notify.pushbullet
        data_template:
          message: >
             Achtung! {{ now().strftime('%d.%m.%Y %H:%M:%S') }} {{ trigger.to_state.attributes.friendly_name }} ist offline!

#################################################
### Notify when a switch goes Offline         ###
#################################################
  - alias: critical device Sensor State
    initial_state: True
    trigger:
      platform: state
      entity_id:

        - sensor.switch_sonoff_sonoff1
        - sensor.switch_sonoff_sonoff2
        - sensor.switch_sonoff_sonoff3
        - sensor.switch_sonoff_sonoff4
        - sensor.switch_sonoff_sonoff5
        - sensor.switch_sonoff_sonoff6
        - sensor.switch_sonoff_sonoff7
        - sensor.switch_sonoff_sonoff8
        - sensor.switch_wemo_wemoswitch1
        - sensor.switch_wemo_wemoswitch2

      from: 'Online'
      to: 'Offline'
      for:
        minutes: 2
    action:
      - service: notify.pushbullet
        data_template:
          message: >
             Achtung! {{ now().strftime('%d.%m.%Y %H:%M:%S') }} {{ trigger.to_state.attributes.friendly_name }} ist offline!
#################################################
### Announce new devices on the network       ###
### Thanks 2 @robotsandcakes                  ###
#################################################
  - alias: "New device connected"
    initial_state: true
    trigger:
      - platform: event
        event_type: device_tracker_new_device
    action:
      - service: notify.pushbullet
        data_template:
          message: >
            Neues Gerät gefunden: {{ trigger.event.data.entity_id }} Hostname: {{ trigger.event.data.host_name }}
